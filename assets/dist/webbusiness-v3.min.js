var Booking=function(){return Booking.fn.init()};Booking.fn=Booking.prototype={lang_code_default:"vn",config:{selectorSelectCategory:".js-selected-category",selectorSelectTour:".js-selected-tour",selectorInfoTour:".js-info-tour",selectorDepartureDay:".js-departure-day",selectorRoomDateStart:".js-room-date-start",selectorRoomDateEnd:".js-room-date-end",selectorInitDate:".js__booking-init-date",selectorLabelWarningSelectedTour:".w30s-alert-selected-tour",selectorHasBookRoom:".js-has-bookroom",urlLoadTour:"/booking/get-tour-json",urlLoadDetail:"/booking/get-detail-json"},quantity:1,init:function(){},setup:function(data){this.handleLoadTour();this.handleSelectTour();this.initDate();this.handleDisableDateEnd();if(data.hasOwnProperty("lang_default")){this.lang_code_default=data.lang_default}if($(this.config.selectorSelectCategory).length>0){loader.showLoader();this.doLoadTour(()=>{let product_id=parseInt($(this.config.selectorSelectTour).data("product-id"));if(product_id>0){$(this.config.selectorSelectTour).val(product_id)}loader.hideLoader()})}$(this.config.selectorSelectCategory).select2({templateResult:this.templateResultSelect2});$(this.config.selectorSelectTour).select2()},templateResultSelect2(state){if(state.hasOwnProperty("id")){state.id=parseInt(state.id)}console.log(state);let htmlText=$("<span>"+state.text+"</span>");if(state.id==0){htmlText=$("<span>"+state.text+"</span>")}else{let level=$(state.element).data("level");console.log(level);switch(level){case 2:htmlText=$("<span>&nbsp; &#8618;&nbsp;"+state.text+"</span>");break;case 3:htmlText=$("<span>&nbsp; &nbsp; &nbsp; &#8618;&nbsp;"+state.text+"</span>");break}}return htmlText},doLoadTour(callback){let id=$(this.config.selectorSelectCategory).val();let self=this;if(parseInt(id)>0){$.when(loader.getAjax(self.config.urlLoadTour,{category_id:id})).then(function(resp){$(self.config.selectorSelectTour).html(template.render(resp,"option-tour"));if(typeof callback=="function"){callback()}$(self.config.selectorSelectTour).trigger("change")})}else{if($(this.config.selectorHasBookRoom).length==0){$(self.config.selectorSelectTour).html('<option value="0">'+lang.selected_tour+"</option>")}else{$(self.config.selectorSelectTour).html('<option value="0">'+lang.bookroom_name+"</option>")}$(self.config.selectorSelectTour).trigger("change")}},handleLoadTour:function(){let self=this;$(this.config.selectorSelectCategory).change(function(){self.doLoadTour()})},handleSelectTour:function(){let self=this;$(self.config.selectorSelectTour).change(function(){let id=$(this).val();if(parseInt(id)>0){$.when(loader.getAjax(self.config.urlLoadDetail,{id:id})).then(function(resp){$(self.config.selectorLabelWarningSelectedTour).fadeOut();$(self.config.selectorInfoTour).html(template.render({data:resp.data,lang:lang},"info-tour"))})}else{$(self.config.selectorInfoTour).html("");$(self.config.selectorLabelWarningSelectedTour).fadeIn()}})},initDate:function(){let self=this;let code_lang=self.lang_code_default=="vn"?"vi":self.lang_code_default;$(this.config.selectorInitDate).datetimepicker({locale:code_lang,format:"DD/MM/YYYY HH:mm",icons:{time:"fal fa-alarm-clock",today:"fal fa-calendar-day"},widgetPositioning:{vertical:"bottom"},minDate:moment().format(),tooltips:{today:code_lang=="vi"?"Chọn ngày hôm nay":"Select to day"},buttons:{showToday:true},sideBySide:true})},handleDisableDateEnd(){let self=this;$(this.config.selectorRoomDateStart).on("change.datetimepicker",function(){})}};